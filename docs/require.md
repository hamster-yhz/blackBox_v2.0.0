# **黑盒博客网站需求文档**

## **1. 项目概述**

### **1.1 项目目标**

- 构建一个名为"黑盒"的纯前端静态博客网站，专注于技术分享和个人思考
- 网站名称"黑盒"寓意探索未知、解密技术，整体设计风格偏向科技感和神秘感
- 提供简洁的用户体验，支持内容浏览和搜索功能
- 通过静态化实现高性能、低维护成本

### **1.2 项目范围**

- **功能范围**：文章发布、分类管理、标签系统、搜索、多设备适配
- **非功能范围**：纯静态网站，不涉及后端服务

### **1.3 目标用户**

- **访客**：浏览文章、搜索内容、查看分类
- **博主**：通过 Markdown 文件管理文章内容，手动部署更新

### **1.4 技术选型**

| **模块**     | **技术栈**                              |
| ------------ | --------------------------------------- |
| **框架**     | Vue 3 + Vite                            |
| **静态生成** | Vite                                    |
| **内容管理** | Markdown 文件存储文章，通过前端解析渲染 |
| **部署**     | Cloudflare Pages（主站）                |
| **UI/UX**    | Tailwind CSS                            |
| **性能优化** | Vite 构建优化、图片懒加载               |

---

## **2. 功能需求**

### **2.1 核心功能**

#### **2.1.1 文章展示**

- **需求描述**：
  - 支持通过 Markdown 文件存储文章，包含标题、内容、发布时间、分类、标签
  - 文章列表页和详情页，详情页需展示作者、发布时间、目录导航
  - 文章支持代码高亮、图片懒加载
- **实现方式**：
  - 使用 `marked.js` 渲染 Markdown，`highlight.js` 实现代码高亮
  - 文章列表按发布时间倒序排列，默认显示摘要（前 200 字）

#### **2.1.2 分类**

- **需求描述**：
  - 主要分类：技术、生活、思考
  - 支持通过分类筛选文章
- **实现方式**：
  - 在 Markdown 文件头部添加 `categories` 元数据
  - 前端通过路由参数动态过滤文章

#### **2.1.3 搜索功能**

- **需求描述**：
  - 全局搜索框，支持标题、内容的模糊匹配
  - 搜索结果实时显示
- **实现方式**：
  - 使用 `fuse.js` 实现本地搜索

#### **2.1.4 响应式设计**

- **需求描述**：
  - 支持移动端、平板、PC 端
  - 移动端采用汉堡菜单，PC 端采用顶部导航
- **实现方式**：
  - 使用 Tailwind CSS 的响应式类

---

## **3. 非功能需求**

### **3.1 性能要求**

- **加载速度**：
  - 首屏内容在 2 秒内加载完成
  - 页面切换流畅
- **文件压缩**：
  - CSS/JS 文件启用 Gzip 压缩
  - 图片使用 WebP 格式，支持懒加载

### **3.2 兼容性**

- **浏览器支持**：
  - Chrome 最新版本、Firefox 最新版本、Safari 14+、Edge 最新版本
- **设备支持**：
  - 所有主流手机（iOS/Android）、平板、桌面端

---

## **4. 设计规范**

### **4.1 UI/UX 设计**

- **配色方案**：
  - 主色调：深空黑（#1A1A1A） + 科技蓝（#00A8FF）
  - 背景色：亮色模式（#FFFFFF），暗色模式（#121212）
- **字体**：
  - 标题：Inter（Google Fonts）
  - 正文：Noto Sans SC（中英文兼容）
- **布局**：
  - PC 端：两栏布局（侧边栏 + 主内容区）
  - 移动端：单栏布局

### **4.2 交互规范**

- **导航栏**：
  - 固定在顶部，包含博客标题、分类菜单、搜索框
- **文章页**：
  - 侧边栏显示目录（自动生成 Markdown 头部锚点）
  - 文章底部显示相关文章推荐

---

## **5. 内容管理**

### **5.1 文章结构**

```markdown
---
title: "文章标题"
date: "2024-03-20"
categories: ["技术"]
tags: ["Vue", "TypeScript"]
cover: "/images/cover.jpg"
excerpt: "文章摘要"
---
```

### **5.2 部署流程**

1. **开发阶段**：
   - 使用 Vite 启动本地服务器（`npm run dev`）
2. **构建与部署**：
   - 运行 `npm run build` 生成静态文件
   - 推送到 GitHub 仓库，自动部署到 GitHub Pages

---

## **6. Cloudflare Pages 部署配置**

### **6.1 部署要求**

- **构建命令**：`npm run build`
- **构建输出目录**：`dist`
- **Node.js 版本**：18.x

### **6.2 部署步骤**

1. **准备阶段**：

   - 确保项目根目录有 `package.json` 和 `vite.config.ts`
   - 确保 `dist` 目录在 `.gitignore` 中

2. **Cloudflare 配置**：

   - 在 Cloudflare Pages 创建新项目
   - 连接 GitHub 仓库
   - 设置构建配置：
     ```
     构建命令：npm run build
     构建输出目录：dist
     Node.js 版本：18
     ```
   - 设置自定义域名（可选）

3. **部署验证**：
   - 检查构建日志
   - 验证网站可访问性

### **6.3 注意事项**

- 确保 `vite.config.ts` 中设置了正确的 `base` 路径
- 检查所有静态资源路径是否正确
- 定期检查构建日志和部署状态

---

## **7. 交付物**

1. **源代码**：
   - 完整的前端代码（含 Markdown 文章模板）
2. **部署文档**：
   - 详细说明如何部署到 Cloudflare Pages
3. **维护指南**：
   - 如何添加新文章、更新分类、修改主题样式

---

## **8. 风险与约束**

- **静态页面的局限性**：
  - 内容更新需手动部署
- **SEO 限制**：
  - 需依赖搜索引擎的自然收录

---

## **9. 附录**

- **参考文档**：
  - [Vue 3 官方文档](https://v3.vuejs.org/)
  - [Tailwind CSS 文档](https://tailwindcss.com/)
  - [Cloudflare Pages 文档](https://developers.cloudflare.com/pages/)

---

### **下一步建议**

1. **原型设计**：
   - 使用 Figma 设计网站原型，确认视觉风格
2. **技术验证**：
   - 搭建基础框架，验证技术选型可行性
3. **内容规划**：
   - 准备首批文章内容，规划分类和标签体系

## **10. 账号系统需求**

### **10.1 功能需求**

#### **10.1.1 邮箱登录系统**
- **需求描述**：
  - 仅支持指定邮箱列表中的用户登录
  - 使用邮箱验证码进行登录
  - 登录状态持久化，支持自动登录
  - 支持登出功能
  - 未登录用户可以正常浏览网站内容
  - 只有登录用户才能进行文章管理操作
- **实现方式**：
  - 使用 Cloudflare Workers 处理认证逻辑
  - 使用 Cloudflare KV 存储白名单邮箱列表和用户会话
  - 使用 Cloudflare Email Workers 发送验证码
  - 使用 localStorage 存储登录状态

#### **10.1.2 文章管理功能**
- **需求描述**：
  - 所有用户可以浏览文章
  - 只有登录用户可以：
    - 上传 Markdown 格式文章
    - 编辑已发布文章
    - 删除文章
  - 支持文章预览功能
  - 支持文章草稿功能
- **实现方式**：
  - 使用 GitHub API 存储和管理 Markdown 文件
  - 使用 GitHub Issues 存储文章元数据
  - 前端实现 Markdown 编辑器（使用 tiptap 或类似的编辑器）
  - 前端根据登录状态显示/隐藏管理功能

### **10.2 技术方案**

#### **10.2.1 后端服务**
- **Cloudflare 服务**：
  - Workers：处理所有 API 请求和业务逻辑
  - KV：存储用户会话和白名单
  - Email Workers：处理邮件发送
  - Pages：部署静态前端
- **GitHub 服务**：
  - GitHub API：存储和管理 Markdown 文件
  - GitHub Issues：存储文章元数据
  - GitHub Actions：自动化部署流程

#### **10.2.2 前端实现**
- **认证流程**：
  ```typescript
  // 登录流程
  1. 用户输入邮箱
  2. 前端调用 Worker API 验证邮箱
  3. Worker 检查白名单并发送验证码
  4. 用户输入验证码
  5. Worker 验证成功后返回会话令牌
  6. 前端存储会话令牌
  ```

- **文章管理流程**：
  ```typescript
  // 文章发布流程
  1. 用户编写 Markdown 内容
  2. 前端调用 Worker API 上传文章
  3. Worker 验证用户权限
  4. Worker 通过 GitHub API 创建/更新 Markdown 文件
  5. Worker 通过 GitHub API 创建/更新文章元数据
  6. GitHub Actions 自动触发 Pages 重新构建
  ```

### **10.3 安全考虑**
- **邮箱白名单**：
  - 在 KV 中维护白名单列表
  - 定期审核和更新白名单
- **数据安全**：
  - 所有 API 请求都需要验证会话令牌
  - 使用 Workers 的权限系统控制访问
  - 使用 GitHub 的访问令牌进行 API 调用
- **防滥用措施**：
  - 使用 Workers 的 Rate Limiting 限制请求频率
  - 实现文章审核机制

### **10.4 部署方案**
- **静态内容**：
  - 继续使用 Cloudflare Pages 部署静态内容
- **动态功能**：
  - 使用 Workers 处理所有动态功能
  - 使用 GitHub 存储数据
- **构建流程**：
  - 文章更新后自动触发 Pages 构建
  - 使用 GitHub Actions 自动化部署流程

### **10.5 维护计划**
- **定期检查**：
  - 监控 Workers 运行情况
  - 检查文章发布频率
  - 审核白名单邮箱列表
- **备份策略**：
  - GitHub 自动备份所有内容
  - 定期导出用户数据
- **更新机制**：
  - 定期更新 Workers 代码
  - 维护白名单列表

### **10.6 性能优化**
- **边缘计算**：
  - 利用 Workers 的全球边缘网络
  - 减少请求延迟
- **缓存策略**：
  - 使用 Workers 的缓存 API
  - 实现合理的缓存策略
- **数据同步**：
  - 使用 GitHub 的版本控制功能
  - 确保数据一致性
